<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body class="dashboard">
  <nav class="navbar">
    <div class="navbar-content">
      <a class="navbar-brand" href="#">My POS</a>
      <ul class="navbar-nav">
        <li><a href="/dashboard" class="active">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</a></li>
        <li><a href="/pos">‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>
        <li><a href="/products">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>
        <li><a href="/reports">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</a></li>
        <li><a href="/settings">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</a></li>
      </ul>
      <div class="user-info">
        <span id="userName">...</span>
        <button class="logout-btn" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>
  </nav>

  <main class="main-content">
    <div class="page-header">
      <h1>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</h1>
      <p>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
    </div>

    <div class="cards-grid">
      <div class="card">
        <div class="card-header">
          <div class="card-title">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
          <div class="card-icon">üí∞</div>
        </div>
        <div class="card-value" id="totalSales">0</div>
        <div class="card-subtitle">‡∏ö‡∏≤‡∏ó</div>
      </div>
      <div class="card">
        <div class="card-header">
          <div class="card-title">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
          <div class="card-icon">üì¶</div>
        </div>
        <div class="card-value" id="totalProducts">0</div>
        <div class="card-subtitle">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
      </div>
      <div class="card">
        <div class="card-header">
          <div class="card-title">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</div>
          <div class="card-icon">üë•</div>
        </div>
        <div class="card-value" id="totalUsers">0</div>
        <div class="card-subtitle">‡∏Ñ‡∏ô</div>
      </div>
    </div>
  </main>

  <script>
    const token = localStorage.getItem('access_token');
    if (!token) {
      window.location.href = "/login";
    }

    fetch('/api/auth/profile', {
      headers: {
        'Authorization': 'Bearer ' + token
      }
    })
    .then(res => res.json())
    .then(data => {
      document.getElementById("userName").innerText = data.user.username;
    });

    fetch('/api/reports/dashboard-stats', {
      headers: {
        'Authorization': 'Bearer ' + token
      }
    })
    .then(res => res.json())
    .then(data => {
      document.getElementById("totalSales").innerText = data.total_sales;
      document.getElementById("totalProducts").innerText = data.total_products;
      document.getElementById("totalUsers").innerText = data.total_users;
    });

    function logout() {
      localStorage.removeItem("access_token");
      window.location.href = "/login";
    }
  </script>
</body>
</html>
